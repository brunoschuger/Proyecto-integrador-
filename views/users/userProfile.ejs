<!DOCTYPE html>
<html lang="en">

<head><%- include('../partials/head') %>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/perfil.css">
</head>

<body>
  <%- include ('../partials/header') %>

    <main>
      <div class="perfil">
        <div class="foto-perfil">
          <img id="profileImage" src="<%=userFromDB.profileImg + '?cache=' + Date.now()%>" alt="avatar">
          <form id="uploadForm" action="/users/<%= userFromDB.id %>/uploadProfileImage" method="POST" enctype="multipart/form-data">
            <input  type="file" name="profileImg" accept=".jpg, .jpeg, .png">
            <button class="cambiar-foto" type="submit">Cambiar Foto</button>
          </form>
        </div>
        
        
        <br>
        <%= user.first_name + " " + user.last_name%>
          <br>
          <% if (user && user.admin) { %>
            <a href="/products/createProduct"><button class="boton-crear">Crear Producto</button></a>
            <% } %>
    </main>
    </div>

    <div class="datos-titulo">
      <p>TUS DATOS</p>
    </div>
    <div class="tus-datos">
 
      <p>Nombre de usuario: <%= userFromDB.username %>
      </p>
      <p>Correo electrónico: <%= userFromDB.email %>
      </p>
    </div>

    <div class="datos-titulo-datos">
      <p>¿Querés modificar tus datos?</p>
    </div>
    <div class="tus-datos">

      <form action="/users/<%= userFromDB.id %>/userProfile" method="POST">

        <label for="username">Nombre de usuario:</label>
        <input type="text" name="username" value="<%= userFromDB.username %>">
        <label for="email">Correo electrónico:</label>
        <input type="email" id = "emailEdit" name="email" value="<%= userFromDB.email %>">
        
        <br>
        <div class="nivel-contraseña">

          <label for="currentPassword">Contraseña actual:</label>
          <input type="password" id="currentPasswordEdit" name="currentPassword">
          
          <label for="newPassword">Nueva contraseña:</label>
          <input type="password" id = "newPasswordEdit" name="newPassword"> <br><br>
         

        </div>
<!--         <% if (errors && errors.length > 0) { %>
          <div class="error-messages">
            <ul>
              <% errors.forEach(error => { %>
                <li><%= error.msg %></li>
              <% }); %>
            </ul>
          </div>
        <% } %>
       -->
        
        <div class="boton-guardar">
          <button id="submitEditProfile" type="submit">Guardar cambios</button>
          <span id="emailEditMessage" style="color: red;"></span>
          <span id="passwordMessage" class="error-message"></span> 
        </div>
      </form>
    </div>




    <!--- Comienzo del footer-->
    <%- include ('../partials/footer')%>
    <script src="/js/profile-validation.js"></script>

</body>

</html>